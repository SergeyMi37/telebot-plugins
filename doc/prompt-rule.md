–í–æ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –æ–ø—Ü–∏–∏ –¥–ª—è Ollama API —Å –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏:

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

```objectscript
Set requestObj = {
    "model": "llama2",          // (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
    "prompt": "Hello",          // (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) –¢–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞
    "stream": false,            // –ü–æ—Ç–æ–∫–æ–≤—ã–π –æ—Ç–≤–µ—Ç (true/false)
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    "format": "json",           // –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ (json)
    "options": {                // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
        // —Å–º. —Ä–∞–∑–¥–µ–ª options –Ω–∏–∂–µ
    },
    "template": "{{.Prompt}}",  // –®–∞–±–ª–æ–Ω –¥–ª—è –ø—Ä–æ–º—Ç–∞
    "system": "You are helpful",// –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç
    "context": [123, 456],      // –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æÂØπËØù
    "raw": false,               // –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—ã (true/false)
    "keep_alive": "5m"         // –í—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –≤ –ø–∞–º—è—Ç–∏
}
```

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Å–µ–∫—Ü–∏–∏ `options`

```objectscript
"options": {
    // üî¢ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–≤–æ–¥–∞
    "num_predict": 128,         // –ú–∞–∫—Å. –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    "temperature": 0.8,         // –°–ª—É—á–∞–π–Ω–æ—Å—Ç—å (0.0-1.0, 0.0 = –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
    "top_k": 40,                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ vocabulary (0-100)
    "top_p": 0.9,               // Nucleus sampling (0.0-1.0)
    "min_p": 0.05,              // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞
    "typical_p": 0.95,          // Typical sampling
    
    // üéØ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
    "repeat_penalty": 1.1,      // –®—Ç—Ä–∞—Ñ –∑–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è (>1.0)
    "presence_penalty": 0.0,    // –®—Ç—Ä–∞—Ñ –∑–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
    "frequency_penalty": 0.0,   // –®—Ç—Ä–∞—Ñ –∑–∞ —á–∞—Å—Ç–æ—Ç—É —Ç–æ–∫–µ–Ω–æ–≤
    "repeat_last_n": 64,        // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è —à—Ç—Ä–∞—Ñ–∞
    "penalize_newline": false,  // –®—Ç—Ä–∞—Ñ–æ–≤–∞—Ç—å –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
    
    // ‚è±Ô∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    "num_ctx": 2048,            // –†–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    "num_batch": 512,           // –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
    "num_thread": 4,            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤
    
    // üß† –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
    "num_gpu": 1,               // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ GPU —Å–ª–æ–µ–≤
    "main_gpu": 0,              // –û—Å–Ω–æ–≤–Ω–æ–π GPU
    "low_vram": false,          // –†–µ–∂–∏–º –Ω–∏–∑–∫–æ–π –ø–∞–º—è—Ç–∏
    "f16_kv": true,             // 16-–±–∏—Ç–Ω—ã–µ –∫–ª—é—á–∏/–∑–Ω–∞—á–µ–Ω–∏—è
    "vocab_only": false,        // –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∫–∞ vocabulary
    "use_mmap": true,           // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ mmap
    "use_mlock": false,         // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏ –≤ –ø–∞–º—è—Ç–∏
    
    // üìä –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
    "mirostat": 0,              // Mirostat (0=off, 1=v1, 2=v2)
    "mirostat_tau": 5.0,        // Mirostat target entropy
    "mirostat_eta": 0.1,        // Mirostat learning rate
    
    // üõë –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
    "stop": ["\n", "###"],      // –°—Ç—Ä–æ–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    "tfs_z": 1.0,               // Tail-free sampling
    
    // üîç –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–±–æ—Ä–∫–∏
    "seed": 0,                  // Seed –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞ (0=random)
}
```

## üìù –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

```objectscript
ClassMethod CompleteOllamaRequest(prompt As %String) As %DynamicObject
{
    Set requestObj = {
        "model": "llama2",
        "prompt": (prompt),
        "stream": false,
        "format": "json",
        "system": "–¢—ã –ø–æ–º–æ—â–Ω–∏–∫. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ —Ç–æ—á–Ω–æ.",
        "raw": false,
        "keep_alive": "10m",
        "options": {
            // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
            "num_predict": 100,
            "temperature": 0.7,
            "top_k": 50,
            "top_p": 0.9,
            "min_p": 0.05,
            "typical_p": 0.95,
            
            // –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
            "repeat_penalty": 1.2,
            "presence_penalty": 0.1,
            "frequency_penalty": 0.1,
            "repeat_last_n": 64,
            "penalize_newline": false,
            
            // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
            "num_ctx": 4096,
            "num_batch": 512,
            "num_thread": 8,
            
            // GPU/–ø–∞–º—è—Ç—å
            "num_gpu": 2,
            "main_gpu": 0,
            "low_vram": false,
            "f16_kv": true,
            "use_mmap": true,
            "use_mlock": false,
            
            // –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ
            "mirostat": 0,
            "mirostat_tau": 5.0,
            "mirostat_eta": 0.1,
            
            // –û—Å—Ç–∞–Ω–æ–≤–∫–∞
            "stop": ["\n", "###", "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:"],
            "tfs_z": 0.95,
            
            // –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º
            "seed": 123456789
        }
    }
    
    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞...
    Return ##class(Your.ClassName).ExecuteOllamaRequest(requestObj)
}
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á

### 1. –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–±–µ–∑ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π):
```objectscript
"options": {
    "num_predict": 1,
    "temperature": 0.0,
    "top_k": 1,
    "top_p": 0.01,
    "repeat_penalty": 2.0,
    "stop": [".", "!", "?", "\n"]
}
```

### 2. –î–ª—è —Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ –ø–∏—Å—å–º–∞:
```objectscript
"options": {
    "num_predict": 500,
    "temperature": 0.9,
    "top_p": 0.95,
    "repeat_penalty": 1.1,
    "mirostat": 2
}
```

### 3. –î–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤:
```objectscript
"options": {
    "num_predict": 300,
    "temperature": 0.3,
    "top_p": 0.8,
    "typical_p": 0.9,
    "repeat_penalty": 1.3
}
```

## üìä –û—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞

```objectscript
Set response = {
    "model": "llama2",          // –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
    "created_at": "2023-12-01T12:00:00Z",
    "response": "Hello!",       // –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞
    "done": true,               // –ó–∞–≤–µ—Ä—à–µ–Ω–æ –ª–∏ –ø–æ–∫–æ–ª–µ–Ω–∏–µ
    "context": [123, 456],      // –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è
    "total_duration": 500000000,// –û–±—â–µ–µ –≤—Ä–µ–º—è –≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö
    "load_duration": 100000000, // –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏
    "prompt_eval_count": 5,     // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø—Ä–æ–º—Ç–µ
    "prompt_eval_duration": 100000000,
    "eval_count": 10,           // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
    "eval_duration": 300000000  // –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
}
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**: `model` –∏ `prompt`
2. **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞**: `0.0` = –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, `1.0` = —Å–ª—É—á–∞–π–Ω—ã–π
3. **–ü–æ—Ç–æ–∫–æ–≤—ã–π —Ä–µ–∂–∏–º**: `stream: true` –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
4. **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `context` –∏–∑ –æ—Ç–≤–µ—Ç–∞ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞
5. **–ü–∞–º—è—Ç—å**: `keep_alive` –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –≤ –ø–∞–º—è—Ç–∏

–≠—Ç–æ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã API Ollama. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–≥—É—Ç –Ω–µ–º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–µ—Ä—Å–∏–∏ Ollama –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏.